{# templates/admin/plats/list.html.twig #}
<div class="ajx-list">
<h1 class="plats-header">
    Liste des plats
    <button class="filter-toggle" data-type="plats" data-url="{{ path('admin_plats_list') }}">
        <img src="{{ asset('Visuels/Icônes/Filter_DarkBrown.png') }}" alt="Filtrer">
    </button>
</h1>

<button class="ajax-btn add-plat" 
        data-url="{{ path('admin_plats_new') }}" 
        data-default="false">
    <img src="{{ asset('Visuels/Icônes/Plus_Beige.png') }}" alt="Créer un plat">
    Créer un plat
</button>

<div class="filter-panel" data-type="plats">
    <button class="close-panel">
        <img src="{{ asset('Visuels/Icônes/Croix_DarkBrown.png') }}" alt="Fermer">
    </button>

    <div class="filter-group">
        <label for="category-filter">Filtrer par catégorie</label>
        <select id="category-filter" name="category">
            <option value="">Tous</option>
            {% for category in categories %}
                <option value="{{ category.id }}">{{ category.libelle }}</option>
            {% endfor %}
        </select>
    </div>

    <div class="filter-group">
        <label for="allergene-filter">Filtrer par allergènes</label>
        <select id="allergene-filter" name="allergene">
            <option value="">Tous</option>
            {% for allergene in allergenes %}
                <option value="{{ allergene.id }}">{{ allergene.libelle }}</option>
            {% endfor %}
        </select>
    </div>

    <div class="filter-group">
        <label for="keyword-filter">Mot-clé</label>
        <input type="text" id="keyword-filter" name="keyword" placeholder="Rechercher..." value="{{ app.request.query.get('keyword') }}">
    </div>

    <button type="button" class="apply-filters">Appliquer</button>
    <button type="button" class="reset-filters">Réinitialiser les filtres</button>
</div>


<table class="plats-table">
    <thead>
        <tr>
            <th>Nom du plat</th>
            <th>Catégorie</th>
            <th>Allergènes</th>
            <th>Image</th>
            <th>Actions</th>
        </tr>
    </thead>

    <tbody>
        {% for plat in plats %}
            <tr>
                <td>{{ plat.titrePlat }}</td>
                <td>{{ plat.category ? plat.category.libelle : '-' }}</td>

                <td>
                    {% if plat.allergenes|length > 0 %}
                        {% for allergene in plat.allergenes %}
                            <img src="{{ asset(allergene.icone) }}" 
                                alt="{{ allergene.libelle }}" 
                                class="allergene-icon" 
                                title="{{ allergene.libelle }}">
                        {% endfor %}
                    {% else %}
                        -
                    {% endif %}
                </td>

                <td>
                    {% if plat.image %}
                        <img src="{{ asset(plat.image) }}" alt="{{ plat.altTexte }}" class="image-plat">
                    {% else %}
                        -
                    {% endif %}
                </td>

                    <td class="action-buttons">
                        <button class="ajax-btn btn-see" data-url="{{ path('admin_plats_show', {'id': plat.id}) }}">
                            <img src="{{ asset('Visuels/Icônes/See_Beige.png')}}" class="image-plat">
                            Voir &amp; modifier
                        </button>
                    </td>
            </tr>
        {% else %}
            <tr>
                <td>Aucun plat trouvé.</td>
            </tr>
        {% endfor %}
    </tbody>
</table>
</div>