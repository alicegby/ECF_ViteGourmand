{# templates/admin/fromages/list.html.twig #}
{% block title %}Liste des fromages{% endblock %}

{% block body %}
<h1>Liste des fromages</h1>

<a href="{{ path('fromages_new') }}" class="btn">
    <img src="{{ asset('Visuels/Icônes/Plus_Beige.png') }}" alt="Ajouter">Nouveau Fromage
</a>

<form method="get" action="{{ path ('fromages_list') }}" class="filter-form">

    <label for="category">Catégorie : </label>
    <select name="category" id="category">
        <option value="">Toutes</option>
        {% for category in categories %}
            <option value="{{ category.id }}" {% if selectedCategory == category.id %}selected{% endif %}>
                {{ category.nom }}
            </option>
        {% endfor %}
    </select>

    <label for="keyword">Mot-clé : </label>
    <input type="text" name="keyword" id="keyword" value="{{ keyword|default('') }}" placeholder="Nom du fromage">

    <button type="submit" class="btn">
        <img src="{{ asset('Visuels/Icônes/Search_Beige.png') }}" alt="Filtrer">Filtrer
    </button>

</form>

<table>
    <thead>
        <tr>
            <th>Nom du fromage</th>
            <th>Catégorie</th>
            <th>Description</th>
            <th>Stock</th>
            <th>Minimum de commande</th>
            <th>Prix par fromage</th>
            <th>Image</th>
            <th>Actions</th>
        </tr>
    </thead>
    <tbody>
        {% for fromage in fromages %}
        <tr>
            <td>{{ fromage.titreFromage }}</td>
            <td>{{ fromage.category ? fromage.category.nom : '-' }}</td>
            <td>{{ fromage.description }}</td>
            <td>{{ fromage.stock }}</td>
            <td>{{ fromage.minCommande }}</td>
            <td>{{ fromage.prixParFromage }}</td>
            <td>
                {% if fromage.image %}
                    <img src="{{ asset(fromage.image) }}" alt="{{ fromage.altTexte }}">
                {% else %}
                        - 
                {% endif %}
            </td>
            <td class="actions">
                <a href="{{ path('fromages_show', {'id': fromage.id}) }}" class="btn">
                    <img src="{{ asset('Visuels/Icônes/See_Beige.png') }}" alt="Voir">Voir
                </a>
                <a href="{{ path('fromages_edit', {'id': fromage.id}) }}" class="btn">
                    <img src="{{ asset('Visuels/Icônes/Edit_Beige.png') }}" alt="Modifier">Modifier
                </a>
                <form action="{{ path('fromages_delete', {'id': fromage.id}) }}" method="post" onsubmit="return confirm('Supprimer ce fromage ?');">
                    <input type="hidden" name="_token" value="{{ csrf_token('delete' ~ fromage.id) }}">
                    <button type="submit" class="btn">
                            <img src="{{ asset('Visuels/Icônes/Delete_Beige.png') }}" alt="Supprimer">Supprimer
                        </button>
                </form>
            </td>
        </tr>
    {% else %}
    <tr>
        <td>Aucun fromage trouvé.</td>
    </tr>
    {% endfor %}
    </tbody>
</table>
{% endblock %}